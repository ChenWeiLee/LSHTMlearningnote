<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>醫學統計學</title>
  <meta name="description" content="在LSHTM的學習筆記">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="醫學統計學" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/cover.jpg" />
  <meta property="og:description" content="在LSHTM的學習筆記" />
  <meta name="github-repo" content="winterwang/LSHTMlearningnote" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="醫學統計學" />
  
  <meta name="twitter:description" content="在LSHTM的學習筆記" />
  <meta name="twitter:image" content="img/cover.jpg" />

<meta name="author" content="王 超辰 Chaochen Wang">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="-log-likelihood-ratio.html">
<link rel="next" href="section-15.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">在LSHTM的學習筆記</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>我是誰</a></li>
<li class="part"><span><b>I 概率論 Probability</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> 概率論入門：定義與公理</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#section-1.1"><i class="fa fa-check"></i><b>1.1</b> 三個概率公理：</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#-conditional-probability"><i class="fa fa-check"></i><b>1.2</b> 條件概率 Conditional probability</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#-independence-"><i class="fa fa-check"></i><b>1.3</b> 獨立 (independence) 的定義</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#section-1.4"><i class="fa fa-check"></i><b>1.4</b> 賭博問題</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#section-1.5"><i class="fa fa-check"></i><b>1.5</b> 賭博問題的答案</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Bayes-Definition.html"><a href="Bayes-Definition.html"><i class="fa fa-check"></i><b>2</b> Bayes 貝葉斯理論的概念</a></li>
<li class="chapter" data-level="3" data-path="-expectation-or-mean-variance.html"><a href="-expectation-or-mean-variance.html"><i class="fa fa-check"></i><b>3</b> 期望 Expectation (或均值 or mean) 和 方差 Variance</a><ul>
<li class="chapter" data-level="3.1" data-path="-expectation-or-mean-variance.html"><a href="-expectation-or-mean-variance.html#section-3.1"><i class="fa fa-check"></i><b>3.1</b> 方差的性質：</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="-bernoulli-distribution.html"><a href="-bernoulli-distribution.html"><i class="fa fa-check"></i><b>4</b> 伯努利分佈 Bernoulli distribution</a></li>
<li class="chapter" data-level="5" data-path="-binomial-distribution.html"><a href="-binomial-distribution.html"><i class="fa fa-check"></i><b>5</b> 二項分佈的概念 Binomial distribution</a><ul>
<li class="chapter" data-level="5.1" data-path="-binomial-distribution.html"><a href="-binomial-distribution.html#section-5.1"><i class="fa fa-check"></i><b>5.1</b> 二項分佈的期望和方差</a></li>
<li class="chapter" data-level="5.2" data-path="-binomial-distribution.html"><a href="-binomial-distribution.html#-hypergeometric-distribution"><i class="fa fa-check"></i><b>5.2</b> 超幾何分佈 hypergeometric distribution</a></li>
<li class="chapter" data-level="5.3" data-path="-binomial-distribution.html"><a href="-binomial-distribution.html#section-5.3"><i class="fa fa-check"></i><b>5.3</b> 樂透中獎概率問題：</a><ul>
<li class="chapter" data-level="5.3.1" data-path="-binomial-distribution.html"><a href="-binomial-distribution.html#-3-"><i class="fa fa-check"></i><b>5.3.1</b> 如果我只想中其中的 <span class="math inline">\(3\)</span> 個號碼，概率有多大？</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="-poisson-distribution.html"><a href="-poisson-distribution.html"><i class="fa fa-check"></i><b>6</b> 泊松分佈 Poisson Distribution</a></li>
<li class="chapter" data-level="7" data-path="section-7.html"><a href="section-7.html"><i class="fa fa-check"></i><b>7</b> 正態分佈</a><ul>
<li class="chapter" data-level="7.1" data-path="section-7.html"><a href="section-7.html#-probability-density-function-pdf"><i class="fa fa-check"></i><b>7.1</b> 概率密度曲線 probability density function， PDF</a></li>
<li class="chapter" data-level="7.2" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>7.2</b> 正態分佈</a></li>
<li class="chapter" data-level="7.3" data-path="section-7.html"><a href="section-7.html#section-7.3"><i class="fa fa-check"></i><b>7.3</b> 標準正態分佈</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="CLT.html"><a href="CLT.html"><i class="fa fa-check"></i><b>8</b> 中心極限定理 the Central Limit Theorem</a><ul>
<li class="chapter" data-level="8.1" data-path="CLT.html"><a href="CLT.html#-covariance"><i class="fa fa-check"></i><b>8.1</b> 協方差 Covariance</a></li>
<li class="chapter" data-level="8.2" data-path="CLT.html"><a href="CLT.html#-correlation"><i class="fa fa-check"></i><b>8.2</b> 相關 Correlation</a></li>
<li class="chapter" data-level="8.3" data-path="CLT.html"><a href="CLT.html#-the-central-limit-theorem"><i class="fa fa-check"></i><b>8.3</b> 中心極限定理 the Central Limit Theorem</a></li>
<li class="chapter" data-level="8.4" data-path="CLT.html"><a href="CLT.html#section-8.4"><i class="fa fa-check"></i><b>8.4</b> 二項分佈的正態分佈近似</a></li>
<li class="chapter" data-level="8.5" data-path="CLT.html"><a href="CLT.html#section-8.5"><i class="fa fa-check"></i><b>8.5</b> 泊松分佈的正態分佈近似</a></li>
<li class="chapter" data-level="8.6" data-path="CLT.html"><a href="CLT.html#continuity-corrections"><i class="fa fa-check"></i><b>8.6</b> 正態分佈模擬的校正：continuity corrections</a><ul>
<li class="chapter" data-level="8.6.1" data-path="CLT.html"><a href="CLT.html#section-8.6.1"><i class="fa fa-check"></i><b>8.6.1</b> 例題</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="CLT.html"><a href="CLT.html#section-8.7"><i class="fa fa-check"></i><b>8.7</b> 兩個連續隨機變量</a></li>
<li class="chapter" data-level="8.8" data-path="CLT.html"><a href="CLT.html#-"><i class="fa fa-check"></i><b>8.8</b> 兩個連續隨機變量 例子：</a></li>
<li class="chapter" data-level="8.9" data-path="CLT.html"><a href="CLT.html#section-8.9"><i class="fa fa-check"></i><b>8.9</b> 條件分佈和邊緣分佈的概念</a></li>
<li class="chapter" data-level="8.10" data-path="CLT.html"><a href="CLT.html#section-8.10"><i class="fa fa-check"></i><b>8.10</b> 條件分佈和邊緣分佈的例子</a><ul>
<li class="chapter" data-level="8.10.1" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>8.10.1</b> 例題</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II 統計推斷 Inference</b></span></li>
<li class="chapter" data-level="9" data-path="section-9.html"><a href="section-9.html"><i class="fa fa-check"></i><b>9</b> 統計推斷的概念</a><ul>
<li class="chapter" data-level="9.1" data-path="section-9.html"><a href="section-9.html#-population-and-sample"><i class="fa fa-check"></i><b>9.1</b> 人羣與樣本 (population and sample)</a></li>
<li class="chapter" data-level="9.2" data-path="section-9.html"><a href="section-9.html#-sample-and-statistic"><i class="fa fa-check"></i><b>9.2</b> 樣本和統計量 (sample and statistic)</a></li>
<li class="chapter" data-level="9.3" data-path="section-9.html"><a href="section-9.html#-estimation"><i class="fa fa-check"></i><b>9.3</b> 估計 Estimation</a></li>
<li class="chapter" data-level="9.4" data-path="section-9.html"><a href="section-9.html#-confidence-intervals"><i class="fa fa-check"></i><b>9.4</b> 信賴區間 confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html"><i class="fa fa-check"></i><b>10</b> 估計和精確度 Estimation and Precision</a><ul>
<li class="chapter" data-level="10.1" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#CI-for-sample-mean"><i class="fa fa-check"></i><b>10.1</b> 估計量和他們的樣本分佈</a></li>
<li class="chapter" data-level="10.2" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#section-10.2"><i class="fa fa-check"></i><b>10.2</b> 估計量的特質</a><ul>
<li class="chapter" data-level="10.2.1" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#section-10.2.1"><i class="fa fa-check"></i><b>10.2.1</b> 偏倚</a></li>
<li class="chapter" data-level="10.2.2" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#-efficiency"><i class="fa fa-check"></i><b>10.2.2</b> 估計量的效能 Efficiency</a></li>
<li class="chapter" data-level="10.2.3" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#section-10.2.3"><i class="fa fa-check"></i><b>10.2.3</b> 均值和中位數的相對效能</a></li>
<li class="chapter" data-level="10.2.4" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#-mean-square-error-mse"><i class="fa fa-check"></i><b>10.2.4</b> 均方差 mean square error (MSE)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#section-10.3"><i class="fa fa-check"></i><b>10.3</b> 總體方差的估計，自由度</a></li>
<li class="chapter" data-level="10.4" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#section-10.4"><i class="fa fa-check"></i><b>10.4</b> 樣本方差的樣本分佈</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html"><i class="fa fa-check"></i><b>11</b> 卡方分佈 Chi-square distribution</a><ul>
<li class="chapter" data-level="11.1" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-11.1"><i class="fa fa-check"></i><b>11.1</b> 卡方分佈的期望和方差的證明</a><ul>
<li class="chapter" data-level="11.1.1" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-11.1.1"><i class="fa fa-check"></i><b>11.1.1</b> 卡方分佈的期望</a></li>
<li class="chapter" data-level="11.1.2" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-11.1.2"><i class="fa fa-check"></i><b>11.1.2</b> 卡方分佈的方差</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="likelihood-definition.html"><a href="likelihood-definition.html"><i class="fa fa-check"></i><b>12</b> 似然 Likelihood</a><ul>
<li class="chapter" data-level="12.1" data-path="likelihood-definition.html"><a href="likelihood-definition.html#-vs.-probability-vs.inference"><i class="fa fa-check"></i><b>12.1</b> 概率 vs. 推斷 Probability vs. Inference</a></li>
<li class="chapter" data-level="12.2" data-path="likelihood-definition.html"><a href="likelihood-definition.html#-likelihood-and-maximum-likelihood-estimators"><i class="fa fa-check"></i><b>12.2</b> 似然和極大似然估計 Likelihood and maximum likelihood estimators</a></li>
<li class="chapter" data-level="12.3" data-path="likelihood-definition.html"><a href="likelihood-definition.html#section-12.3"><i class="fa fa-check"></i><b>12.3</b> 似然方程的一般化定義</a></li>
<li class="chapter" data-level="12.4" data-path="likelihood-definition.html"><a href="likelihood-definition.html#-log-likelihood"><i class="fa fa-check"></i><b>12.4</b> 對數似然方程 log-likelihood</a></li>
<li class="chapter" data-level="12.5" data-path="likelihood-definition.html"><a href="likelihood-definition.html#-maximum-likelihood-estimator-mle-"><i class="fa fa-check"></i><b>12.5</b> 極大似然估計 (maximum likelihood estimator, MLE) 的性質：</a></li>
<li class="chapter" data-level="12.6" data-path="likelihood-definition.html"><a href="likelihood-definition.html#likelihood-poi"><i class="fa fa-check"></i><b>12.6</b> 率的似然估計 Likelihood for a rate</a></li>
<li class="chapter" data-level="12.7" data-path="likelihood-definition.html"><a href="likelihood-definition.html#-n-"><i class="fa fa-check"></i><b>12.7</b> 有 <span class="math inline">\(n\)</span> 個獨立觀察時的似然方程和對數似然方程</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html"><i class="fa fa-check"></i><b>13</b> 對數似然比 Log-likelihood ratio</a><ul>
<li class="chapter" data-level="13.1" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html#section-13.1"><i class="fa fa-check"></i><b>13.1</b> 正態分佈數據的極大似然和對數似然比</a></li>
<li class="chapter" data-level="13.2" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html#n-"><i class="fa fa-check"></i><b>13.2</b> <span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比</a></li>
<li class="chapter" data-level="13.3" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html#n-"><i class="fa fa-check"></i><b>13.3</b> <span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比的分佈</a></li>
<li class="chapter" data-level="13.4" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html#section-13.4"><i class="fa fa-check"></i><b>13.4</b> 似然比信賴區間</a><ul>
<li class="chapter" data-level="13.4.1" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html#binomial-ex"><i class="fa fa-check"></i><b>13.4.1</b> 以二項分佈數據爲例</a></li>
<li class="chapter" data-level="13.4.2" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html#normal-ex"><i class="fa fa-check"></i><b>13.4.2</b> 以正態分佈數據爲例</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html#exercise"><i class="fa fa-check"></i><b>13.5</b> Exercise</a><ul>
<li class="chapter" data-level="13.5.1" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html#q1"><i class="fa fa-check"></i><b>13.5.1</b> Q1</a></li>
<li class="chapter" data-level="13.5.2" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html#q2"><i class="fa fa-check"></i><b>13.5.2</b> Q2</a></li>
<li class="chapter" data-level="13.5.3" data-path="-log-likelihood-ratio.html"><a href="-log-likelihood-ratio.html#q3"><i class="fa fa-check"></i><b>13.5.3</b> Q3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="-approximate-log-likelihood-ratios.html"><a href="-approximate-log-likelihood-ratios.html"><i class="fa fa-check"></i><b>14</b> 二次方程近似法求對數似然比 approximate log-likelihood ratios</a><ul>
<li class="chapter" data-level="14.1" data-path="-approximate-log-likelihood-ratios.html"><a href="-approximate-log-likelihood-ratios.html#-normal-approximation-to-the-log-likelihood"><i class="fa fa-check"></i><b>14.1</b> 正態近似法求對數似然 Normal approximation to the log-likelihood</a><ul>
<li class="chapter" data-level="14.1.1" data-path="-approximate-log-likelihood-ratios.html"><a href="-approximate-log-likelihood-ratios.html#section-14.1.1"><i class="fa fa-check"></i><b>14.1.1</b> 近似法估算對數似然比的信賴區間</a></li>
<li class="chapter" data-level="14.1.2" data-path="-approximate-log-likelihood-ratios.html"><a href="-approximate-log-likelihood-ratios.html#section-14.1.2"><i class="fa fa-check"></i><b>14.1.2</b> 以泊松分佈爲例</a></li>
<li class="chapter" data-level="14.1.3" data-path="-approximate-log-likelihood-ratios.html"><a href="-approximate-log-likelihood-ratios.html#section-14.1.3"><i class="fa fa-check"></i><b>14.1.3</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="-approximate-log-likelihood-ratios.html"><a href="-approximate-log-likelihood-ratios.html#-parameter-transformations"><i class="fa fa-check"></i><b>14.2</b> 參數轉化 parameter transformations</a><ul>
<li class="chapter" data-level="14.2.1" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>14.2.1</b> 以泊松分佈爲例</a></li>
<li class="chapter" data-level="14.2.2" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>14.2.2</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="-approximate-log-likelihood-ratios.html"><a href="-approximate-log-likelihood-ratios.html#exercise-1"><i class="fa fa-check"></i><b>14.3</b> Exercise</a><ul>
<li class="chapter" data-level="14.3.1" data-path="-approximate-log-likelihood-ratios.html"><a href="-approximate-log-likelihood-ratios.html#q1-1"><i class="fa fa-check"></i><b>14.3.1</b> Q1</a></li>
<li class="chapter" data-level="14.3.2" data-path="-approximate-log-likelihood-ratios.html"><a href="-approximate-log-likelihood-ratios.html#q2-1"><i class="fa fa-check"></i><b>14.3.2</b> Q2</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III 統計分析方法 Analytical Techniques</b></span></li>
<li class="chapter" data-level="15" data-path="section-15.html"><a href="section-15.html"><i class="fa fa-check"></i><b>15</b> 探索數據和簡單描述</a></li>
<li class="part"><span><b>IV 貝葉斯統計</b></span></li>
<li class="chapter" data-level="16" data-path="section-16.html"><a href="section-16.html"><i class="fa fa-check"></i><b>16</b> 貝葉斯統計入門</a><ul>
<li class="chapter" data-level="16.1" data-path="section-16.html"><a href="section-16.html#section-16.1"><i class="fa fa-check"></i><b>16.1</b> 概率論推斷的複習</a></li>
<li class="chapter" data-level="16.2" data-path="section-16.html"><a href="section-16.html#-bayesian-reasoninginverse-probability"><i class="fa fa-check"></i><b>16.2</b> 貝葉斯概率推理/逆概率 Bayesian reasoning/inverse probability</a><ul>
<li class="chapter" data-level="16.2.1" data-path="section-16.html"><a href="section-16.html#-deductive-reasoning---weak-syllogisms"><i class="fa fa-check"></i><b>16.2.1</b> 演繹推理 deductive reasoning 和 三段論 weak syllogisms</a></li>
<li class="chapter" data-level="16.2.2" data-path="section-16.html"><a href="section-16.html#-quantifying-plausibility"><i class="fa fa-check"></i><b>16.2.2</b> 如何給可能性定量 Quantifying plausibility</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="section-16.html"><a href="section-16.html#section-16.3"><i class="fa fa-check"></i><b>16.3</b> 貝葉斯推理的統計學實現</a><ul>
<li class="chapter" data-level="16.3.1" data-path="section-16.html"><a href="section-16.html#-diagnostic-testing"><i class="fa fa-check"></i><b>16.3.1</b> 醫學診斷測試 diagnostic testing</a></li>
<li class="chapter" data-level="16.3.2" data-path="section-16.html"><a href="section-16.html#hiv-"><i class="fa fa-check"></i><b>16.3.2</b> HIV 檢查時的應用</a></li>
<li class="chapter" data-level="16.3.3" data-path="section-16.html"><a href="section-16.html#section-16.3.3"><i class="fa fa-check"></i><b>16.3.3</b> 說點小歷史</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="section-16.html"><a href="section-16.html#section-16.4"><i class="fa fa-check"></i><b>16.4</b> 練習題</a></li>
</ul></li>
<li class="part"><span><b>V 臨床實驗 Clinical Trials</b></span></li>
<li class="chapter" data-level="17" data-path="section-17.html"><a href="section-17.html"><i class="fa fa-check"></i><b>17</b> 樣本量計算問題</a><ul>
<li class="chapter" data-level="17.1" data-path="section-17.html"><a href="section-17.html#section-17.1"><i class="fa fa-check"></i><b>17.1</b> 背景</a></li>
<li class="chapter" data-level="17.2" data-path="section-17.html"><a href="section-17.html#section-17.2"><i class="fa fa-check"></i><b>17.2</b> 決定所需樣本量大小的統計學因素</a></li>
<li class="chapter" data-level="17.3" data-path="section-17.html"><a href="section-17.html#-type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>17.3</b> 第一類和第二類錯誤 Type I and type II errors</a></li>
<li class="chapter" data-level="17.4" data-path="section-17.html"><a href="section-17.html#-percentages-or-proportions"><i class="fa fa-check"></i><b>17.4</b> 比較兩組之間的百分比 (percentages or proportions)</a><ul>
<li class="chapter" data-level="17.4.1" data-path="section-17.html"><a href="section-17.html#--5--90"><i class="fa fa-check"></i><b>17.4.1</b> 樣本量計算公式 (使用顯著水平 5%, 和檢驗效能 90%)</a></li>
<li class="chapter" data-level="17.4.2" data-path="CLT.html"><a href="CLT.html#-"><i class="fa fa-check"></i><b>17.4.2</b> 樣本量計算公式的一般化 (不同的顯著水平和檢驗效能條件下)</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="section-17.html"><a href="section-17.html#section-17.5"><i class="fa fa-check"></i><b>17.5</b> 比較兩組之間的均值</a><ul>
<li class="chapter" data-level="17.5.1" data-path="section-17.html"><a href="section-17.html#section-17.5.1"><i class="fa fa-check"></i><b>17.5.1</b> 樣本量計算公式</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="section-17.html"><a href="section-17.html#section-17.6"><i class="fa fa-check"></i><b>17.6</b> 樣本量計算的調整</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">醫學統計學</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="-approximate-log-likelihood-ratios" class="section level1">
<h1><span class="header-section-number">第 14 章</span> 二次方程近似法求對數似然比 approximate log-likelihood ratios</h1>
<p>爲什麼要用二次方程近似對數似然比方程？</p>
<ol style="list-style-type: decimal">
<li>上節也看到，我們會碰上難以用代數學計算獲得對數似然比信賴區間的情況 (Section <a href="-log-likelihood-ratio.html#binomial-ex">13.4.1</a>: binomial example)。</li>
<li>我們同時知道，對數似然比方程會隨着樣本量增加而越來越漸進於二次方程，且左右對稱。</li>
<li>所以，我們考慮當樣本量足夠大時，用二次方程來近似對數似然比方程從而獲得參數估計的信賴區間。</li>
</ol>
<div id="-normal-approximation-to-the-log-likelihood" class="section level2">
<h2><span class="header-section-number">14.1</span> 正態近似法求對數似然 Normal approximation to the log-likelihood</h2>
<p>根據前一節 (Section <a href="-log-likelihood-ratio.html#normal-ex">13.4.2</a>)，如果樣本均數的分佈符合正態分佈：<span class="math inline">\(\bar{X}\sim N(\mu, \sigma^2/n)\)</span>。那麼樣本均數的對數似然比爲：</p>
<p><span class="math display">\[llr(\mu|\bar{X})=\ell(\mu|\bar{X})=-\frac{1}{2}(\frac{\bar{x}-\mu}{\sigma/\sqrt{n}})^2\]</span></p>
<p>其中， <span class="math inline">\(\bar{x}\)</span> 是正態分佈總體均數 <span class="math inline">\(\mu\)</span> 的極大似然估計 (maximum likelihood estimator, MLE)。如果已知總體的方差參數，那麼 <span class="math inline">\(\sigma/\sqrt{n}\)</span> 是 <span class="math inline">\(\bar{x}\)</span> 的標準誤 (standard error)。</p>
<p>因此，假設 <span class="math inline">\(\theta\)</span> 是我們想尋找的總體參數。有些人提議可以使用下面的關於 <span class="math inline">\(\theta\)</span> 的二次方程來做近似：</p>
<p><span class="math display">\[f(\theta|data)=-\frac{1}{2}(\frac{\theta-M}{S})^2\]</span></p>
<p>上述方程具有一個正態二次對數似然 (比) 的形式，而且該方程的極大似然估計(MLE)， <span class="math inline">\(M\)</span> 的標準誤爲 <span class="math inline">\(S\)</span>。如果我們正確地選用 <span class="math inline">\(M\)</span> 和 <span class="math inline">\(S\)</span>，那我們就可以用這樣的方程來近似求真實觀察數據的似然 <span class="math inline">\(\ell(\theta|data)\)</span>。</p>
<p>通過近似正態對數似然比，<span class="math inline">\(M\)</span> 應當選用使方程取最大值時，參數 <span class="math inline">\(\theta\)</span> 的極大似然估計 <span class="math inline">\(M=\hat{\Theta}\)</span>。</p>
<p>但是在選用標準誤 <span class="math inline">\(S\)</span> 上必須滿足下列條件：</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(S\)</span> 是極大似然估計 <span class="math inline">\(\hat{\Theta}\)</span> 的標準誤。</li>
<li>被選擇的 <span class="math inline">\(S\)</span> 必須儘可能的使該二次方程形成一個十分接近真實的對數似然比方程。特別是在最大值的部分必須與之無限接近或者一致。所以二者在 MLE 的位置應當有相同的曲率（二階導數）。</li>
</ol>
<p>由於，一個方程的曲率是該方程的二階導數（斜線斜率變化的速度）。所以對數似然比方程在 MLE 取最大值時的曲率（二階導數）爲：</p>
<p><span class="math display">\[\left.\frac{d^2}{d\theta^2}\ell(\theta)\right\vert_{\theta=\hat{\theta}}=\ell^{\prime\prime}(\hat{\theta})=-\frac{1}{S^2}\\
\Rightarrow S^2=\left.-\frac{1}{\ell^{\prime\prime}(\theta)}\right\vert_{\theta=\hat{\theta}}
\]</span></p>
<p>在正態分佈的例子下，<span class="math inline">\(M=\bar{x}, S=\sigma/\sqrt{n}\)</span>。對數似然比方程最大值時的曲率（二階導數）恰好就爲標準誤的平方的負倒數：</p>
<p><span class="math inline">\(\ell^{\prime\prime}(\theta)=-\frac{1}{SE^2}\)</span> <span class="math inline">\(\Rightarrow\)</span> 被叫做 <strong>Fisher information</strong>。</p>
<p>稍微總結一下：</p>
<ol style="list-style-type: decimal">
<li>任意的對數似然比方程 <span class="math inline">\(llr(\theta)\)</span> 都可以考慮用一個二次方程來近似： <span class="math display">\[f(\theta|data)=-\frac{1}{2}(\frac{\theta-M}{S})^2\]</span></li>
<li>其中<br> <span class="math inline">\(\begin{aligned} &amp;M=\hat\theta\\ &amp;S^2=\left.-\frac{1}{\ell^{\prime\prime}(\theta)}\right\vert_{\theta=\hat{\theta}}\\ &amp;when \\  &amp; n\rightarrow\infty \Rightarrow  \begin{cases}  S^2\rightarrow Var(\hat\theta) \\  S\rightarrow SE(\hat\theta)  \end{cases} \end{aligned}\)</span></li>
</ol>
<div id="section-14.1.1" class="section level3">
<h3><span class="header-section-number">14.1.1</span> 近似法估算對數似然比的信賴區間</h3>
<p>一旦我們決定了使用正態近似法來模擬對數似然比方程，對數似然比的信賴區間算法就回到了前一節中我們算過的方法，也就是：</p>
<p><span class="math display">\[-2f(\theta)&lt;\mathcal{X}_{1,(1-\alpha)}^2\]</span></p>
<p>故信賴區間爲： <span class="math inline">\(m\pm\sqrt{\mathcal{X}_{1,(1-\alpha)}^2}S\)</span>。求<span class="math inline">\(95\%\)</span> 水平的信賴區間時，<span class="math inline">\(\mathcal{X}_{1,0.95}^2=3.84\)</span>，所以就又看到了熟悉的 <span class="math inline">\(M\pm1.96S\)</span>。</p>
</div>
<div id="section-14.1.2" class="section level3">
<h3><span class="header-section-number">14.1.2</span> 以泊松分佈爲例</h3>
<p>一個被追蹤的樣本，經過了 <span class="math inline">\(p\)</span> 人年的觀察，記錄到了 <span class="math inline">\(d\)</span> 個我們要研究的事件：</p>
<p><span class="math display">\[D\sim Poi(\mu), where \mu=\lambda p\]</span></p>
<p>Step 1. 找極大似然估計 (MLE)，之前介紹似然方程時推導過的泊松分佈的似然方程 (Section <a href="likelihood-definition.html#likelihood-poi">12.6</a>)：</p>
<p><span class="math display">\[\begin{aligned}
P(D=d|\lambda) &amp;= \frac{e^{-\mu}\cdot\mu^d}{d!} \\
 &amp;=\frac{e^{-\lambda p}\cdot\lambda^d p^d}{d!} \\
omitting&amp;\;terms\;not\;in\;\mu \\
&amp;\Rightarrow \ell(\lambda) = dlog\lambda - \lambda p \\
&amp;\Rightarrow \ell^\prime(\lambda) = \frac{d}{\lambda} -p \\
&amp;\Rightarrow \hat\lambda=\frac{d}{p} = \textbf{M}
\end{aligned}\]</span></p>
<p>Step 2. 求似然方程的二階導數，確認 MLE 是使方程獲得最大值的點，然後確定 <span class="math inline">\(S^2\)</span>：</p>
<p><span class="math display">\[\begin{aligned}
&amp; \ell^\prime(\lambda) = \frac{d}{\lambda} -p \\
&amp; \Rightarrow \ell^{\prime\prime}(\lambda) = -\frac{d}{\lambda^2}&lt;0 \Rightarrow \textbf{MLE is maximum} \\
&amp; S^2 = \left.-\frac{1}{\ell^{\prime\prime}(\lambda)}\right\vert_{\lambda=\hat{\lambda}=d/p} = -\frac{1}{-d/\hat\lambda^2} = -\frac{1}{-d/(d/p)^2} \\
&amp;\Rightarrow S^2 = \frac{d}{p^2} \\
\end{aligned}\]</span></p>
<p>Step 3. 把前兩部求得的 <span class="math inline">\(MLE\)</span> 和 <span class="math inline">\(S^2\)</span> 代入近似的二次方程：</p>
<p><span class="math display">\[\begin{aligned}
&amp; \hat\lambda=\frac{d}{p}=M,\; S^2 = \frac{d}{p^2}  \\
&amp; using\;approximate\;quadratic\;llr \\
&amp; q(\lambda) = -\frac{1}{2}(\frac{\lambda-M}{S})^2\\
&amp;\Rightarrow q(\lambda) = -\frac{1}{2}(\frac{\lambda-\frac{d}{p}}{\frac{\sqrt{d}}{p}})^2\\
&amp; let \; q(\lambda)=-1.92\\
&amp;\Rightarrow -\frac{1}{2}(\frac{\lambda-\frac{d}{p}}{\frac{\sqrt{d}}{p}})^2=-1.92\\
&amp;(\frac{\lambda-\frac{d}{p}}{\frac{\sqrt{d}}{p}})^2=3.84\\
&amp;\frac{\lambda-\frac{d}{p}}{\frac{\sqrt{d}}{p}} = \pm1.96\\
&amp;\Rightarrow 95\%CI \;for \;\lambda = \frac{d}{p}\pm1.96\frac{\sqrt{d}}{p}
\end{aligned}\]</span></p>
<p>結論就是： 發病（死亡）率 <span class="math inline">\(\lambda\)</span> 的 <span class="math inline">\(95\%\)</span> 信賴區間爲： <span class="math inline">\(M\pm1.96S\)</span>。所以我們不需要每次都代入對數似然比方程，只要算出 <span class="math inline">\(MLE = M\)</span> 和 <span class="math inline">\(S\)</span> 之後代入這個公式就可以用二次方程近似法算出信賴區間。</p>
</div>
<div id="section-14.1.3" class="section level3">
<h3><span class="header-section-number">14.1.3</span> 以二項分佈爲例</h3>
<p><span class="math display">\[K\sim Bin(n,\pi)\]</span></p>
<p>Step 1. 找極大似然估計 (MLE)：</p>
<p><span class="math display">\[
\begin{aligned}
&amp; Prob(K=k) = \pi^k(1-\pi)\binom{n}{k}\\
&amp;\Rightarrow L(\pi|k) = \pi^k(1-\pi)\binom{n}{k}\\
&amp;omitting\;terms\;not\;in\;\pi \\
&amp;\Rightarrow \ell(\pi) = k\:log\pi+(n-k)log(1-\pi) \\
&amp;\ell^\prime(\pi) = \frac{k}{\pi}-\frac{n-k}{1-\pi} \\
&amp; let\;\ell^\prime(\hat\pi) =0 \\
&amp;\Rightarrow \frac{k}{\hat\pi}-\frac{n-k}{1-\hat\pi}=0\\
&amp;\Rightarrow \frac{\hat\pi}{1-\hat\pi}=\frac{k}{n-k}\\
&amp;\Rightarrow \frac{\hat\pi}{1-\hat\pi}=\frac{k/n}{1-k/n}\\
&amp;\Rightarrow \hat\pi=\frac{k}{n} = p = \textbf{M}
\end{aligned}
\]</span></p>
<p>Step 2. 將對數似然方程的二次微分 (二階導數)，確認在 MLE 爲極大值，並確認 <span class="math inline">\(S^2\)</span>：</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\ell^\prime(\pi) = \frac{k}{\pi}-\frac{n-k}{1-\pi} \\
&amp;\ell^{\prime\prime}(\pi)=\frac{-k}{\pi^2}-\frac{n-k}{(1-\pi)^2} &lt;0 \\
&amp;\therefore at\;\textbf{MLE}\;\ell(\pi)\;has\;maximum \\
S^2&amp;=\left.-\frac{1}{\ell^{\prime\prime}(\pi)}\right\vert_{\pi=\hat\pi=k/n=p}\\
&amp;=\frac{1}{\frac{k}{\hat\pi^2}+\frac{n-k}{(1-\hat\pi)^2}}\\
&amp;=\frac{\hat\pi^2(1-\hat\pi)^2}{k(1-\hat\pi)^2+(n-k)\hat\pi^2}\\
&amp;=\frac{P^2(1-P)^2}{np(1-p)^2+(n-np)p^2}\\
&amp;=\frac{p(1-p)}{n(1-p)+np}\\
&amp;=\frac{p(1-p)}{n}\\
&amp;\Rightarrow S=\sqrt{\frac{p(1-p)}{n}}
\end{aligned}
\]</span></p>
<p>Step 3. 將求得的 MLE 和 <span class="math inline">\(S^2\)</span> 代入近似信賴區間：</p>
<p><span class="math display">\[
95\% CI \;for \; \pi:\\
M\pm1.96S=p\pm1.96\sqrt{\frac{p(1-p)}{n}}\\
\]</span></p>
</div>
</div>
<div id="-parameter-transformations" class="section level2">
<h2><span class="header-section-number">14.2</span> 參數轉化 parameter transformations</h2>
<p>如果將參數 <span class="math inline">\(\theta\)</span> 通過某種數學方程轉化成 <span class="math inline">\(g(\theta)\)</span>，那麼我們可以認爲，轉化後的方程的 MLE 爲 <span class="math inline">\(g(\hat\theta)\)</span>，其中 <span class="math inline">\(\hat\theta\)</span> 是參數 <span class="math inline">\(\theta\)</span> 的 MLE。</p>
<p>類似地，如果 <span class="math inline">\(\theta_1 \sim \theta_2\)</span> 是參數 <span class="math inline">\(\theta\)</span> 的似然比信賴區間，那麼 <span class="math inline">\(g(\theta_1)\sim g(\theta_2)\)</span> 就是 <span class="math inline">\(g(\theta)\)</span> 的似然比信賴區間。</p>
<p>以下爲轉換參數以後獲取信賴區間的步驟：</p>
<ol style="list-style-type: decimal">
<li>將參數通過某些數學方程（通常是取對數）轉化，使新的對數似然比方程更加接近二次方程的對稱圖形。<br> Transform parameter so that <span class="math inline">\(llr\)</span> is closer to a quadratic shape.</li>
<li>用本節學到的二次方程近似法，求得轉化後的參數的似然比信賴區間。 <br> Use our quadratic approximation on the transformed parameter to calculate our likelihood ratio confidence intervals.</li>
<li>將第2步計算獲得的似然比信賴區間再通過轉化參數時的逆函數轉換回去，以獲得原參數的似然比信賴區間。<br> Transform the confidence intervals back, or to any scale we wish – they remain valid.</li>
</ol>
<div id="-1" class="section level3">
<h3><span class="header-section-number">14.2.1</span> 以泊松分佈爲例</h3>
<p>當我們用泊松分佈模擬事件在某段時間內發生率 <span class="math inline">\(\lambda\)</span> 時，注意到這個事件發生率必須滿足 <span class="math inline">\(\lambda&gt;0\)</span>。當事件發生次數較低時，會讓似然方程的圖形被擠壓在低值附近。如果嘗試用對數轉換 <span class="math inline">\(\lambda \rightarrow log(\lambda)\)</span> 此時 <span class="math inline">\(log(\lambda)\)</span> 就不再被限制與 <span class="math inline">\(&gt;0\)</span>。下面我們嘗試尋找對數轉換過後的 <span class="math inline">\(M\)</span> 和 <span class="math inline">\(S\)</span>。</p>
<p>令 <span class="math inline">\(\beta=log(\lambda), \Rightarrow e^\beta=\lambda\)</span> 從本文上半部分中我們已知 <span class="math inline">\(\hat\lambda=\frac{d}{p}\)</span>。</p>
<ul>
<li>對數轉換以後的 <span class="math inline">\(M\)</span> 是什麼? <br>根據定義，<span class="math inline">\(MLE(\beta)=MLE[log(\lambda)]=log(\hat\lambda)\)</span> <span class="math inline">\(\Rightarrow M=\hat\beta=log(\frac{d}{p})\)</span></li>
<li><p>對數轉換以後的 <span class="math inline">\(S\)</span> 是什麼? <br> 泊松分佈的對數似然方程是：<span class="math inline">\(\ell(\lambda|d)=d log(\lambda) - \lambda p\)</span> 用 <span class="math inline">\(\beta\)</span> 替換掉 <span class="math inline">\(\lambda\)</span></p>
<span class="math inline">\(\begin{aligned} &amp; \ell(\beta|d)=d \beta - pe^\beta\\ &amp; \Rightarrow \ell^\prime(\beta)=d-pe^\beta \Rightarrow \ell^{\prime\prime}(\beta)=-pe^\beta \\ &amp; S^2 = \left.-\frac{1}{\ell^{\prime\prime}(\beta)}\right\vert_{\beta=\hat{\beta}} = \left.\frac{1}{pe^\beta}\right\vert_{\beta=\hat{\beta}} = \frac{1}{pe^{log(d/p)}}\\ &amp;\Rightarrow S^2=\frac{1}{d} \therefore S=\frac{1}{\sqrt{d}} \end{aligned}\)</span></li>
<li><p>轉換後的近似二次方程：<br> <span class="math inline">\(\begin{aligned} &amp; q(\beta) = -\frac{1}{2}(\frac{\beta-M}{S})^2 = -\frac{1}{2}(\frac{\beta-log(\frac{d}{p})}{\frac{1}{\sqrt{d}}})^2 \end{aligned}\)</span></p></li>
<li><p><span class="math inline">\(\beta\)</span> 的 <span class="math inline">\(95\%\)</span> 信賴區間 <span class="math inline">\(=log(\frac{d}{p})\pm1.96\frac{1}{\sqrt{d}}\)</span></p></li>
<li><p><span class="math inline">\(\lambda\)</span> 的 <span class="math inline">\(95\%\)</span> 信賴區間 <span class="math inline">\(=exp(log(\frac{d}{p})\pm1.96\frac{1}{\sqrt{d}})\)</span></p></li>
</ul>
</div>
<div id="-1" class="section level3">
<h3><span class="header-section-number">14.2.2</span> 以二項分佈爲例</h3>
<p>在研究對象 <span class="math inline">\(n\)</span> 人中觀察到 <span class="math inline">\(k\)</span> 個人患有某種<del>中二</del>疾病。</p>
<p>令 <span class="math inline">\(\beta=log(\pi) \Rightarrow \pi=e^\beta\)</span> 從上文的推倒也已知 <span class="math inline">\(\hat\pi=\frac{k}{n}=p\)</span></p>
<p><span class="math inline">\(\begin{aligned} &amp;\Rightarrow \ell(\beta)=klog\pi+(n-k)log(1-\pi)=k\beta+(n-k)log(1-e^\beta) \\ &amp;\Rightarrow \ell^{\prime}(\beta)=k-\frac{(n-k)(e^\beta)}{1-e^\beta} \\ &amp;\Rightarrow \ell^{\prime\prime}(\beta)=-(n-k)\frac{e^\beta(1-e^\beta)+e^{2\beta}}{(1-e^\beta)^2} \\ &amp; \ell^{\prime\prime}(\beta)= -(n-k)\frac{e^\beta}{(1-e^\beta)^2}\\ &amp;\Rightarrow S^2 = \left.-\frac{1}{\ell^{\prime\prime}(\beta)}\right\vert_{\beta=\hat{\beta}} = \frac{(1-e^{\hat\beta})^2}{(n-k)e^{\hat\beta}} \\ &amp;\because \hat\beta=log(\hat\pi) \\ &amp;\therefore e^{\hat\beta} = \frac{k}{n}\\ &amp;\Rightarrow S^2=\frac{(1-\frac{k}{n})^2}{(n-k)\frac{k}{n}}=\frac{n-k}{nk}=\frac{1}{k}-\frac{1}{n}\\ &amp; \Rightarrow S=\sqrt{\frac{1}{k}-\frac{1}{n}}\\ \end{aligned}\)</span></p>
</div>
</div>
<div id="exercise-1" class="section level2">
<h2><span class="header-section-number">14.3</span> Exercise</h2>
<div id="q1-1" class="section level3">
<h3><span class="header-section-number">14.3.1</span> Q1</h3>
<ol style="list-style-type: lower-alpha">
<li>在<span class="math inline">\(n=100\)</span>人中觀察到有<span class="math inline">\(k=40\)</span>人患病，假設每個人只有患病，不患病兩個狀態，用二項分佈來模擬這個數據，<span class="math inline">\(\pi\)</span> 爲患病的概率。下面是 <span class="math inline">\(\pi \in [0.2,0.6]\)</span> 區間的對數似然比方程曲線。</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pi &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.2</span>, <span class="fl">0.6</span>, <span class="dt">by=</span><span class="fl">0.01</span>)
L &lt;-<span class="st"> </span>(pi<span class="op">^</span><span class="dv">40</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>pi)<span class="op">^</span><span class="dv">60</span>)
Lmax &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">max</span>(L), <span class="dv">41</span>)
LR &lt;-<span class="st"> </span>L<span class="op">/</span>Lmax
logLR &lt;-<span class="st"> </span><span class="kw">log</span>(LR)

<span class="kw">plot</span>(pi, logLR, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">11</span>, <span class="dv">0</span>),<span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>,
     <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylab =</span> <span class="st">&quot;logLR(\U03C0)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;\U03C0&quot;</span>)
<span class="kw">grid</span>(<span class="ot">NA</span>, <span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) <span class="co"># add some horizontal grid on the background</span>
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">las=</span><span class="dv">2</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:bin-llr-40-100"></span>
<img src="bookdown_files/figure-html/bin-llr-40-100-1.png" alt="Binomial log-likelihood ratio between 0.2-0.6" width="90%" />
<p class="caption">
图 14.1: Binomial log-likelihood ratio between 0.2-0.6
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#title(main = &quot;Figure 1. Binomial log-likelihood ratio&quot;)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>用一個二次方程來模擬上面的對數似然比曲線：<span class="math inline">\(f(\pi)=-\frac{(\pi-M)^2}{2S^2}\)</span>，其中 <span class="math inline">\(M=\hat\pi=\frac{k}{n}=0.4\)</span>，<span class="math inline">\(S^2=\frac{p(1-p)}{n}=0.0024\)</span></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">1.2</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.7</span>))
quad &lt;-<span class="st"> </span><span class="op">-</span>(pi<span class="op">-</span><span class="fl">0.4</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="fl">0.0024</span>)
<span class="kw">plot</span>(pi, quad, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">0</span>),<span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,
     <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;\U03C0&quot;</span>)
<span class="kw">lines</span>(pi, logLR, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)
<span class="kw">grid</span>(<span class="ot">NA</span>, <span class="dv">4</span>, <span class="dt">lwd =</span> <span class="dv">1</span>) <span class="co"># add some horizontal grid on the background</span>
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">las=</span><span class="dv">2</span>)
<span class="co">#title(main = &quot;Figure 2. Quadratic approximation\n of binomial log-likelihood ratio \n 40 out of 100 subjects&quot;)</span>
<span class="kw">abline</span>(<span class="dt">h=</span><span class="op">-</span><span class="fl">1.92</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
<span class="kw">axis</span>(<span class="dv">4</span>, <span class="dt">at=</span><span class="op">-</span><span class="fl">1.92</span>, <span class="dt">las=</span><span class="dv">2</span>)
<span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">0.27</span>, <span class="dt">y=</span> <span class="op">-</span><span class="fl">5.5</span> ,<span class="dt">xpd =</span> <span class="ot">TRUE</span>,  <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;logLR&quot;</span>,<span class="st">&quot;Quadratic&quot;</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,
       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">horiz =</span> <span class="ot">TRUE</span>) <span class="co">#the legend is below the graph</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:qua-apprx-bin"></span>
<img src="bookdown_files/figure-html/qua-apprx-bin-1.png" alt="Quadratic approximation
 of binomial log-likelihood ratio 40 out of 100 subjects" width="90%" />
<p class="caption">
图 14.2: Quadratic approximation of binomial log-likelihood ratio 40 out of 100 subjects
</p>
</div>
</div>
<div id="q2-1" class="section level3">
<h3><span class="header-section-number">14.3.2</span> Q2</h3>
<p>依舊使用二項分佈數據來模擬，觀察不同的事件數量和樣本量對近似計算的影響。</p>
<ol style="list-style-type: decimal">
<li>類比上面的問題，用同樣的 <span class="math inline">\(\hat\pi=0.4\)</span>，但是 <span class="math inline">\(n=10, k=4\)</span> 時的圖形：</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mai =</span> <span class="kw">c</span>(<span class="fl">1.2</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.7</span>))
pi &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.0</span>, <span class="fl">0.85</span>, <span class="dt">by=</span><span class="fl">0.01</span>)
L &lt;-<span class="st"> </span>(pi<span class="op">^</span><span class="dv">4</span>)<span class="op">*</span>((<span class="dv">1</span><span class="op">-</span>pi)<span class="op">^</span><span class="dv">6</span>)
logLR &lt;-<span class="st"> </span><span class="kw">log</span>(L<span class="op">/</span><span class="kw">max</span>(L))

quad &lt;-<span class="st"> </span><span class="op">-</span>(pi<span class="op">-</span><span class="fl">0.4</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="fl">0.4</span><span class="op">*</span><span class="fl">0.6</span><span class="op">/</span><span class="dv">10</span>)
<span class="kw">plot</span>(pi, quad, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">0</span>),<span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,
     <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;\U03C0&quot;</span>)
<span class="kw">lines</span>(pi, logLR, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)
<span class="kw">grid</span>(<span class="ot">NA</span>, <span class="dv">4</span>, <span class="dt">lwd =</span> <span class="dv">1</span>)
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">las=</span><span class="dv">2</span>)
<span class="co">#title(main = &quot;Figure 3. Quadratic approximation\n of binomial log-likelihood ratio\n 4 out of 10 subjects&quot;)</span>
<span class="kw">abline</span>(<span class="dt">h=</span><span class="op">-</span><span class="fl">1.92</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
<span class="kw">axis</span>(<span class="dv">4</span>, <span class="dt">at=</span><span class="op">-</span><span class="fl">1.92</span>, <span class="dt">las=</span><span class="dv">2</span>)

<span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">0.17</span>, <span class="dt">y=</span> <span class="op">-</span><span class="fl">6.5</span> ,<span class="dt">xpd =</span> <span class="ot">TRUE</span>,  <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;logLR&quot;</span>,<span class="st">&quot;Quadratic&quot;</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,
       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">horiz =</span> <span class="ot">TRUE</span>) <span class="co">#the legend is below the graph</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:qua-apprx-bin4-10"></span>
<img src="bookdown_files/figure-html/qua-apprx-bin4-10-1.png" alt="Quadratic approximation of binomial log-likelihood ratio 4 out of 10 subjects" width="90%" />
<p class="caption">
图 14.3: Quadratic approximation of binomial log-likelihood ratio 4 out of 10 subjects
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li><span class="math inline">\(\hat\pi=0.4, n=1000, k=400\)</span></li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:qua-apprx-bin400-1000"></span>
<img src="bookdown_files/figure-html/qua-apprx-bin400-1000-1.png" alt="Quadratic approximation of binomial log-likelihood ratio 400 out of 1000 subjects" width="90%" />
<p class="caption">
图 14.4: Quadratic approximation of binomial log-likelihood ratio 400 out of 1000 subjects
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li><span class="math inline">\(\hat\pi=0.01, n=100, k=1\)</span></li>
</ol>
<p>注意此圖中紅線提示的近似二次曲線，信賴區間的下限已經低於0，是無法接受的近似。</p>
<div class="figure" style="text-align: center"><span id="fig:qua-apprx-bin1-1000"></span>
<img src="bookdown_files/figure-html/qua-apprx-bin1-1000-1.png" alt="Quadratic approximation of binomial log-likelihood ratio 1 out of 100 subjects" width="90%" />
<p class="caption">
图 14.5: Quadratic approximation of binomial log-likelihood ratio 1 out of 100 subjects
</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li><span class="math inline">\(\hat\pi=0.01, n=1000, k=10\)</span></li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:qua-apprx-bin10-1000"></span>
<img src="bookdown_files/figure-html/qua-apprx-bin10-1000-1.png" alt="Quadratic approximation of binomial log-likelihood ratio 10 out of 1000 subjects" width="90%" />
<p class="caption">
图 14.6: Quadratic approximation of binomial log-likelihood ratio 10 out of 1000 subjects
</p>
</div>
<ol start="5" style="list-style-type: decimal">
<li><span class="math inline">\(\hat\pi=0.01, n=10000, k=100\)</span></li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:qua-apprx-bin100-1000"></span>
<img src="bookdown_files/figure-html/qua-apprx-bin100-1000-1.png" alt="Quadratic approximation of binomial log-likelihood ratio 100 out of 10000 subjects" width="90%" />
<p class="caption">
图 14.7: Quadratic approximation of binomial log-likelihood ratio 100 out of 10000 subjects
</p>
</div>
<ol start="6" style="list-style-type: decimal">
<li><span class="math inline">\(\hat\pi=0.99, n=100, k=99\)</span></li>
</ol>
<p>注意此圖中紅線提示的近似二次曲線，信賴區間的上限已經大於1，和上面的 Figure 5. 一樣也是無法接受的近似。</p>
<div class="figure" style="text-align: center"><span id="fig:qua-apprx-bin99-100"></span>
<img src="bookdown_files/figure-html/qua-apprx-bin99-100-1.png" alt="Quadratic approximation of binomial log-likelihood ratio 99 out of 100 subjects" width="90%" />
<p class="caption">
图 14.8: Quadratic approximation of binomial log-likelihood ratio 99 out of 100 subjects
</p>
</div>
<p>總結： 二次方程近似時，在二項分佈的情況下，隨着 <span class="math inline">\(n, k\)</span> 增加，近似越理想。</p>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="-log-likelihood-ratio.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="section-15.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/winterwang/LSHTMlearningnote/edit/master/02-Inference.Rmd",
"text": "编辑"
},
"download": ["bookdown.pdf", "bookdown.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
