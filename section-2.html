<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="section-1.html">
<link rel="next" href="-permutation-procedures.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">在LSHTM的學習筆記</a></li>

<li class="divider"></li>
<li class="part"><span><b>I 穩健統計方法 Robust Statistic Methods</b></span></li>
<li class="chapter" data-level="1" data-path="section-1.html"><a href="section-1.html"><i class="fa fa-check"></i><b>1</b> 穩健統計方法入門</a></li>
<li class="chapter" data-level="2" data-path="section-2.html"><a href="section-2.html"><i class="fa fa-check"></i><b>2</b> 基於秩次的非參數檢驗</a><ul>
<li class="chapter" data-level="2.1" data-path="section-2.html"><a href="section-2.html#-the-sign-test"><i class="fa fa-check"></i><b>2.1</b> 符號檢驗 the Sign test</a><ul>
<li class="chapter" data-level="2.1.1" data-path="section-2.html"><a href="section-2.html#section-2.1.1"><i class="fa fa-check"></i><b>2.1.1</b> 符號檢驗的特點</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="section-2.html"><a href="section-2.html#wilcoxon-the-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>2.2</b> Wilcoxon 符號秩和檢驗，the Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="2.3" data-path="section-2.html"><a href="section-2.html#wilcoxon-mann-whitney-wmw-"><i class="fa fa-check"></i><b>2.3</b> Wilcoxon-Mann-Whitney (WMW) 檢驗</a></li>
<li class="chapter" data-level="2.4" data-path="section-2.html"><a href="section-2.html#spearmans-rank-correlation-coefficient"><i class="fa fa-check"></i><b>2.4</b> 秩相關，Spearman’s Rank Correlation Coefficient</a></li>
<li class="chapter" data-level="2.5" data-path="section-2.html"><a href="section-2.html#section-2.5"><i class="fa fa-check"></i><b>2.5</b> 基於秩次的非參數檢驗的優缺點</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html"><i class="fa fa-check"></i><b>3</b> 排列置換法 Permutation procedures</a><ul>
<li class="chapter" data-level="3.1" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html#section-3.1"><i class="fa fa-check"></i><b>3.1</b> 背景介紹</a></li>
<li class="chapter" data-level="3.2" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html#section-3.2"><i class="fa fa-check"></i><b>3.2</b> 直接上實例</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-2" class="section level1">
<h1><span class="header-section-number">第 2 章</span> 基於秩次的非參數檢驗</h1>
<p>基於秩次的統計學方法不像其他參數檢驗那樣需要太多的假設和前提 (比如服從正態分佈或者其它假設)。這類方法其實放棄了數據的部分信息 – 那就是數據之間值的差距。通過給數據排序列，我們僅僅知道數據的排序。所以我們可以下結論說 <span class="math inline">\(A\)</span> 大於 <span class="math inline">\(B\)</span>，或者 <span class="math inline">\(B\)</span> 大於 <span class="math inline">\(C\)</span> (因此 <span class="math inline">\(A\)</span> 也大於 <span class="math inline">\(C\)</span>)，但是他們之間數值的差距被忽略掉了 (所以我們不能比較 <span class="math inline">\(A-B\)</span> 和 <span class="math inline">\(B-C\)</span> 的大小)。</p>
<p>所以，基於秩次的統計學方法完全只依賴數據的大小<strong>排序</strong>，觀察獲得數據的真實大小被忽視了。</p>
<div id="-the-sign-test" class="section level2">
<h2><span class="header-section-number">2.1</span> 符號檢驗 the Sign test</h2>
<p>我們以下列一組空腹血糖測量值的數據爲例：</p>
<table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-1">表 2.1: </span>Fasting Glucose Level (mmol/L)
</caption>
<thead>
<tr>
<th style="text-align:center; border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;" colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
n=24 Diabetics
</div>
</th>
</tr>
<tr>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
10.3
</td>
<td style="text-align:center;">
8.8
</td>
<td style="text-align:center;">
5.3
</td>
</tr>
<tr>
<td style="text-align:center;">
9.5
</td>
<td style="text-align:center;">
6.7
</td>
<td style="text-align:center;">
6.7
</td>
</tr>
<tr>
<td style="text-align:center;">
12.2
</td>
<td style="text-align:center;">
12.5
</td>
<td style="text-align:center;">
5.2
</td>
</tr>
<tr>
<td style="text-align:center;">
15.1
</td>
<td style="text-align:center;">
4.2
</td>
<td style="text-align:center;">
13.3
</td>
</tr>
<tr>
<td style="text-align:center;">
10.8
</td>
<td style="text-align:center;">
15.3
</td>
<td style="text-align:center;">
7.5
</td>
</tr>
<tr>
<td style="text-align:center;">
19.0
</td>
<td style="text-align:center;">
7.2
</td>
<td style="text-align:center;">
4.9
</td>
</tr>
<tr>
<td style="text-align:center;">
16.1
</td>
<td style="text-align:center;">
9.3
</td>
<td style="text-align:center;">
19.5
</td>
</tr>
<tr>
<td style="text-align:center;">
8.1
</td>
<td style="text-align:center;">
8.6
</td>
<td style="text-align:center;">
11.1
</td>
</tr>
</tbody>
</table>
<p>我們如果想要對這組數據的中位數做出假設檢驗，<span class="math inline">\(H_0: \theta = 10; \text{ v.s. } H_1: \theta\neq10\)</span>。</p>
<p>該選擇哪種檢驗方法來回答這個假設檢驗提出的問題：中位數是否等於 <span class="math inline">\(10\)</span>?</p>
<p>符號檢驗 (the <em>sign test</em>)，可以用來輔助我們對數據的中位數 (median <span class="math inline">\(\theta\)</span>) 作出推斷 (inference)。雖然往下看你會發現嚴格說來這並不算是基於秩次的檢驗方法。使用符號檢驗時我們需要的唯一假設：數據來自連續分佈 (continuous distribution)。</p>
<p>這種類型的檢驗方法常用的假設檢驗如下：</p>
<p><span class="math display">\[
H_0: \theta=\theta_0 \\
H_1: \theta\neq\theta_0
\]</span></p>
<p>其中，<span class="math inline">\(\theta_0\)</span> 就是我們想要檢驗的中位數的大小，在上面的例子中，<span class="math inline">\(\theta_0=10\)</span>。</p>
<p>此時我們用到的檢驗統計量，<span class="math inline">\(X\)</span> 的定義是：樣本數據中比 <span class="math inline">\(\theta_0\)</span> 大的數據個數，和比 <span class="math inline">\(\theta_0\)</span> 小的數據個數，兩個個數中較小的那一個。因爲在零假設的條件下，如果觀察數據的中位數等於 <span class="math inline">\(\theta_0\)</span> 的話，數據中比 <span class="math inline">\(\theta_0\)</span> 大或者小的數據個數應該是相等的。可以用一個二項分佈，概率爲 <span class="math inline">\(0.5\)</span> 的模型來模擬：</p>
<p><span class="math display">\[X\sim Bin(n, 0.5)\]</span></p>
<p>在本例中，觀察數據有 13 個小於 <span class="math inline">\(\theta_0=10\)</span>，有 11 個大於 <span class="math inline">\(\theta_0=10\)</span>。因此 <span class="math inline">\(X=11, n=24\)</span>。假如 <span class="math inline">\(\pi\)</span> 是一個觀察數據大於 <span class="math inline">\(\theta_0\)</span> 的概率的話，在零假設的條件下，<span class="math inline">\(H_0: \pi=0.5\)</span>。檢驗這個假設的雙側概率的計算公式爲：</p>
<p><span class="math display">\[2\times P(X\leqslant x|\pi=0.5)\]</span></p>
<p>在本例中， <span class="math inline">\(X=11\)</span>。如果（像在考試的時候沒有電腦輔助）要用查表的方式判斷 <span class="math inline">\(p\)</span> 值大小。可以先<a href="http://onlinelibrary.wiley.com/doi/10.1002/9780470776124.app1/pdf">下載</a> 一份統計數據的表格。下載好了找到 “Statistical Table 7.1 Critical one- and two-tailed values of x for a Sign test” 在第185頁：(下面只是截圖)</p>
<p><img src="img/Selection_088.png" width="80%" style="display: block; margin: auto;" /> <span class="math display">\[\cdots\cdots\cdots\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="img/Selection_089.png" alt="Critical Values for a Sign test" width="80%" />
<p class="caption">
图 2.1: Critical Values for a Sign test
</p>
</div>
<p>找到 <span class="math inline">\(n=24\)</span> 這一行，發現顯著性水平是 <span class="math inline">\(20\%\)</span> 的拒絕域都要小於 <span class="math inline">\(8\)</span>， 所以本例的 <span class="math inline">\(p&gt;20\%\)</span>。</p>
<p>如果你很幸運沒有在考場上，那麼可以找出自己的電腦下載好 <a href="https://www.r-project.org/">R</a> 之後執行下面的命令：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">2</span><span class="op">*</span><span class="kw">pbinom</span>(<span class="dv">11</span>,<span class="dv">24</span>, <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] 0.8388197</code></pre>
<p>或者可以使用命令 <code>binom.test</code> 來做一個二項分佈的概率檢驗：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">1</span>, <span class="dt">digits =</span> <span class="dv">8</span>) <span class="co"># just to show the p values are exactly the same</span>
<span class="kw">binom.test</span>(<span class="dv">11</span>,<span class="dv">24</span>,<span class="fl">0.5</span>)</code></pre></div>
<pre><code>## 
##  Exact binomial test
## 
## data:  11 and 24
## number of successes = 11, number of trials = 24, p-value = 0.83882
## alternative hypothesis: true probability of success is not equal to 0.5
## 95 percent confidence interval:
##  0.25553020 0.67179192
## sample estimates:
## probability of success 
##             0.45833333</code></pre>
<p>或者你也可以使用 <a href="https://alanarnholt.github.io/BSDA/"><code>BSDA</code></a> 中的 <code>SIGN.test</code> 命令來進行一場轟轟烈烈的符號檢驗：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">1</span>, <span class="dt">digits =</span> <span class="dv">8</span>)
<span class="co"># input the data</span>
dt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">10.3</span>,<span class="fl">9.5</span>,<span class="fl">12.2</span>,<span class="fl">15.1</span>,<span class="fl">10.8</span>,<span class="fl">19.0</span>,<span class="fl">16.1</span>, <span class="fl">8.1</span>, <span class="fl">8.8</span>, <span class="fl">6.7</span>,<span class="fl">12.5</span>, <span class="fl">4.2</span>,<span class="fl">15.3</span>, <span class="fl">7.2</span>, <span class="fl">9.3</span>, <span class="fl">8.6</span>, <span class="fl">5.3</span>,<span class="fl">6.7</span> ,<span class="fl">5.2</span>,<span class="fl">13.3</span>, <span class="fl">7.5</span>, <span class="fl">4.9</span>,<span class="fl">19.5</span>,<span class="fl">11.1</span>)
BSDA<span class="op">::</span><span class="kw">SIGN.test</span>(dt, <span class="dt">md=</span><span class="dv">10</span>, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>, <span class="dt">conf.level=</span><span class="fl">0.95</span>)</code></pre></div>
<pre><code>## 
##  One-sample Sign-Test
## 
## data:  dt
## s = 11, p-value = 0.83882
## alternative hypothesis: true median is not equal to 10
## 95 percent confidence interval:
##   7.3988241 12.3011759
## sample estimates:
## median of x 
##         9.4 
## 
## Achieved and Interpolated Confidence Intervals: 
## 
##                   Conf.Level L.E.pt  U.E.pt
## Lower Achieved CI     0.9361 7.5000 12.2000
## Interpolated CI       0.9500 7.3988 12.3012
## Upper Achieved CI     0.9773 7.2000 12.5000</code></pre>
<p>“據說”如果你用 <a href="https://www.stata.com/"><code>Stata</code></a> 的話還會給你一個絢麗的表格：</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="img/Selection_090.png" alt="The Stata output of a Sign Test" width="80%" />
<p class="caption">
图 2.2: The Stata output of a Sign Test
</p>
</div>
<p>總而言之無論你用的是哪個方法，查 (水) 表法或是統計武俠包，結果都是一樣的：數據無法提供足夠的證據拒絕零假設，即無證據證明中位數不等於10。</p>
<p>需要注意的是，如果觀察數據中有的值恰好等於 <span class="math inline">\(\theta_0\)</span> 那麼這些觀察數據就會被剔除之後再進行檢驗，相應的樣本量 (<span class="math inline">\(n\)</span>) 也就變小了。如果觀察數據樣本兩足夠大，我們可以使用二項分佈的正態分佈近似 (Section <a href="#binomial-normal-approx"><strong>??</strong></a>) 法計算。近似法計算時記得要進行校正 (Section <a href="#continuity-correction"><strong>??</strong></a>)：</p>
<p><span class="math display">\[
z=\frac{\frac{x}{n}-\pi}{\sqrt{\pi(1-\pi)/n}}=\frac{\frac{x}{n}-0.5}{\sqrt{0.5(1-0.5)/n}}=\frac{2x}{\sqrt{n}}-\sqrt{n}\\
\text{With the continuity correction, this becomes: }\\
z=\lvert\frac{2x}{\sqrt{n}}-\sqrt{n}\rvert-\frac{1}{\sqrt{n}}
\]</span></p>
<p>在本例中：</p>
<p><span class="math display">\[z=\lvert\frac{2\times11}{\sqrt{24}}-\sqrt{24}\rvert-\frac{1}{\sqrt{24}}=0.204\]</span></p>
<p>標準正態分佈的 <span class="math inline">\(z\)</span> 爲 <span class="math inline">\(0.204\)</span> 時的雙側 <span class="math inline">\(p\)</span> 值爲：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="fl">0.204</span>))<span class="op">*</span><span class="dv">2</span></code></pre></div>
<pre><code>## [1] 0.8383535</code></pre>
<p>和前面的直接計算法的結果還算是十分接近滴。</p>
<div id="section-2.1.1" class="section level3">
<h3><span class="header-section-number">2.1.1</span> 符號檢驗的特點</h3>
<p>符號檢驗十分的穩健 (Robust)，因爲我們除了數據連續性的假設之外沒有其他任何假設。但是穩健檢驗是有代價的。因爲進行符號檢驗的同時意味着我們要放棄一個個數據本身能提供的信息。結果導致這類檢驗敏感度較低，檢驗效能 (Power) 較差，以及獲得的信賴區間也就很寬 (不精確)。</p>
</div>
</div>
<div id="wilcoxon-the-wilcoxon-signed-rank-test" class="section level2">
<h2><span class="header-section-number">2.2</span> Wilcoxon 符號秩和檢驗，the Wilcoxon signed-rank test</h2>
<p>Wilcoxon 符號秩和檢驗也可以用來檢驗一組數據的中位數是否和某個已知數字相等。進行本方法時除了像符號檢驗那樣要假設數據是連續的以外，還要假設數據的分佈是左右對稱的。因此，由於假定了左右對稱的前提，中位數也就等於均數，所以它也可以被用於檢驗均數是否等於某個已知的值。</p>
<p>Wilcoxon 符號秩和檢驗的前提可以被認爲是介於符號檢驗和單一樣本 <span class="math inline">\(t\)</span> 檢驗 (還假設數據來自於正態分佈) 之間的一種檢驗。</p>
<p>當一組隨機觀察數據 <span class="math inline">\(x_1,\cdots,x_n\)</span> 來自於對稱的連續分佈數據。如果它的中位數是 <span class="math inline">\(\theta\)</span>，在零假設：<span class="math inline">\(H_0: \theta=\theta_0\)</span> 的條件下：</p>
<ol style="list-style-type: decimal">
<li>將全部觀察數據一一和 <span class="math inline">\(\theta_0\)</span> 相減，那麼每一個 <span class="math inline">\(d_i=x_i-\theta_0, i=1,2,\cdots,n\)</span> 的正負符號概率是相等的；</li>
<li>任何一個和 <span class="math inline">\(\theta_0\)</span> 相減之後的差 <span class="math inline">\(\lvert d_i \lvert\)</span> ，取正負符號的概率是相等的。</li>
</ol>
<p>這裏我們使用另一個例子來說明 Wilcoxon 檢驗法。下列數據爲，12名女性從平躺姿勢改成直立時心跳次數的變化 (次/分)。</p>
<p><code>-2, -5, 12, 4, 16, 17, 8, 3, 20, 25, 1, 9</code></p>
<p>下面來使用 Wilcoxon 符號秩和檢驗法來檢驗中位數 <span class="math inline">\(\theta=15\)</span>。</p>
<p>首先，先計算每個數據和 <span class="math inline">\(15\)</span> 之間的差值：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">1</span>, <span class="dv">9</span>)
newdata &lt;-<span class="st"> </span>data<span class="op">-</span><span class="dv">15</span>
newdata</code></pre></div>
<pre><code>##  [1] -17 -20  -3 -11   1   2  -7 -12   5  10 -14  -6</code></pre>
<p>下一步，計算這些差值的絕對值：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">abs_newdata &lt;-<span class="st"> </span><span class="kw">abs</span>(newdata)
abs_newdata</code></pre></div>
<pre><code>##  [1] 17 20  3 11  1  2  7 12  5 10 14  6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Dt &lt;-<span class="st"> </span><span class="kw">data.frame</span>(data, newdata, abs_newdata)
Dt &lt;-<span class="st"> </span>Dt[<span class="kw">order</span>(newdata), ] <span class="co"># sort the data by newdata</span>
Dt</code></pre></div>
<pre><code>##    data newdata abs_newdata
## 2    -5     -20          20
## 1    -2     -17          17
## 11    1     -14          14
## 8     3     -12          12
## 4     4     -11          11
## 7     8      -7           7
## 12    9      -6           6
## 3    12      -3           3
## 5    16       1           1
## 6    17       2           2
## 9    20       5           5
## 10   25      10          10</code></pre>
<p>之後，給絕對值排序：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Dt<span class="op">$</span>ranks &lt;-<span class="st"> </span><span class="kw">rank</span>(Dt<span class="op">$</span>abs_newdata)
Dt</code></pre></div>
<pre><code>##    data newdata abs_newdata ranks
## 2    -5     -20          20    12
## 1    -2     -17          17    11
## 11    1     -14          14    10
## 8     3     -12          12     9
## 4     4     -11          11     8
## 7     8      -7           7     6
## 12    9      -6           6     5
## 3    12      -3           3     3
## 5    16       1           1     1
## 6    17       2           2     2
## 9    20       5           5     4
## 10   25      10          10     7</code></pre>
<p>接下來，給小於 <span class="math inline">\(15\)</span> 的數據的排序加上負號：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Dt<span class="op">$</span>signed_ranks &lt;-<span class="st"> </span><span class="kw">ifelse</span>(Dt<span class="op">$</span>newdata <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>, Dt<span class="op">$</span>ranks<span class="op">*</span>(<span class="op">-</span><span class="dv">1</span>), Dt<span class="op">$</span>ranks)
Dt &lt;-<span class="st"> </span>Dt[<span class="kw">order</span>(Dt<span class="op">$</span>ranks),]
Dt</code></pre></div>
<pre><code>##    data newdata abs_newdata ranks signed_ranks
## 5    16       1           1     1            1
## 6    17       2           2     2            2
## 3    12      -3           3     3           -3
## 9    20       5           5     4            4
## 12    9      -6           6     5           -5
## 7     8      -7           7     6           -6
## 10   25      10          10     7            7
## 4     4     -11          11     8           -8
## 8     3     -12          12     9           -9
## 11    1     -14          14    10          -10
## 1    -2     -17          17    11          -11
## 2    -5     -20          20    12          -12</code></pre>
<p>對正的負的 <code>signed_ranks</code> 分別求和，絕對值較小的那個就是 Wilcoxon 檢驗的統計量。本例中：<span class="math inline">\(S^+=\)</span> 14，<span class="math inline">\(S^-=\)</span> -64，所以本例中的檢驗統計量等於 <span class="math inline">\(14\)</span>。如果要繼續查表的話，可以找到 <span class="math inline">\(0.05&lt;p&lt;0.1\)</span>：</p>
<p><img src="img/Selection_091.png" width="80%" style="display: block; margin: auto;" /> <span class="math display">\[\cdots\cdots\cdots\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<img src="img/Selection_092.png" alt="Critical Values for a Wilcoxon Signed-Ranks test" width="80%" />
<p class="caption">
图 2.3: Critical Values for a Wilcoxon Signed-Ranks test
</p>
</div>
<p>精確的 Wilcoxon 符號秩和檢驗可以通過下列代碼在 <a href="https://www.r-project.org/">R</a> 裏完成：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(Dt<span class="op">$</span>data, <span class="dt">mu=</span><span class="dv">15</span>, <span class="dt">paired =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank test
## 
## data:  Dt$data
## V = 14, p-value = 0.052246
## alternative hypothesis: true location is not equal to 15</code></pre>
<p>如果數據中有觀察值和我們希望比較的數值完全相等的話，和符號檢驗類似的，這些觀察值需要被剔除之後再進行上面的個步驟檢驗。記得還要將樣本量減去相應個數再去查表尋找 <span class="math inline">\(p\)</span> 值。</p>
<p>另外，下面的代碼可以計算正態分佈近似的 Wilcoxon 秩和檢驗，結果十分接近：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(Dt<span class="op">$</span>data, <span class="dt">mu=</span><span class="dv">15</span>, <span class="dt">paired =</span> <span class="ot">FALSE</span>, <span class="dt">exact =</span> <span class="ot">FALSE</span>, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank test
## 
## data:  Dt$data
## V = 14, p-value = 0.04986
## alternative hypothesis: true location is not equal to 15</code></pre>
<p>值得注意的是，精確計算時，我們需要剔除那些和比較數值完全一致的觀察值。然而在正態分佈近似法的 Wilcoxon 檢驗中，這些數值並不會被剔除，而是保留下來，並且用於對方差進行調整。Wilcoxon 秩和檢驗可以在我們能夠假設數據左右對稱分佈，且明顯不服從正態分佈時使用 (即概率密度分布圖左右兩端的尾部較厚的時候)。如果數據左右完全對稱，本檢驗方法不太推薦採用。</p>
</div>
<div id="wilcoxon-mann-whitney-wmw-" class="section level2">
<h2><span class="header-section-number">2.3</span> Wilcoxon-Mann-Whitney (WMW) 檢驗</h2>
<p>本方法用於比較兩組獨立樣本的分佈是否只是<strong>左右位移 (或者叫平移)</strong>。此檢驗需要的假設前提爲：兩組獨立樣本來自連續型分佈，且僅僅只存在整體的<strong>左右位移 (或者叫平移)</strong> (location shift)。</p>
<p>例如說，兩組數據各自的累積概率方程分別是 <span class="math inline">\(F(\cdot), G(\cdot)\)</span> 時，由上面的假設可知：</p>
<p><span class="math display">\[G(y)=F(y-\Delta), \text{ where } -\infty&lt;\Delta&lt;\infty\]</span></p>
<p>上面式子中的 <span class="math inline">\(\Delta\)</span> 就是所謂的 <strong>“左右位移 (或者叫平移)”</strong>。因此本檢驗的零假設和替代假設爲：</p>
<p><span class="math display">\[H_0: \Delta=0\\
  H_1: \Delta\neq0\]</span></p>
<p>在零假設的條件下，我們可以認爲兩個樣本來自相同的人羣分佈。假如，<span class="math inline">\(F, G\)</span> 都是正態分佈，且同方差。那麼 <span class="math inline">\(\Delta\)</span> 就等於兩個分佈的均值差。在這種情況下就可以使用兩樣本 <span class="math inline">\(t\)</span> 檢驗。所以說，WMW 檢驗其實就是把假設前提放寬了的 (免去了正態分佈假設) 兩樣本 <span class="math inline">\(t\)</span> 檢驗。</p>
<p>如果兩個獨立樣本分別有樣本量 <span class="math inline">\(n, m, \text{ and } n&lt;m\)</span>：<span class="math inline">\(X_1,\cdots,X_n\)</span> 和 <span class="math inline">\(Y_1, \cdots, Y_m\)</span>。在零假設的條件下，將這兩個樣本合併之後的大樣本 (<span class="math inline">\(m+n\)</span> 個樣本量) ：<span class="math inline">\(X_1,\cdots,X_n,Y_1, \cdots, Y_m\)</span> 可以視爲來自同一分佈。那麼在合併後的樣本中，我們給每一個元素賦予它們的合併後數據中的排序 (<span class="math inline">\(\text{Rank}_i: i= 1,2,\cdots,n, n+1, \cdots, n+m\)</span>)。那麼我們感興趣的 Wilcoxon 秩和統計量 (Wilcoxon rank sum statistic) <span class="math inline">\(W_1\)</span> 是樣本量較小的那些數字在合併後數據中的排序之和。</p>
<p><span class="math display">\[W_1=\sum_{i=1}^n R_i\]</span></p>
<p>對於大小相同的數據，排序取他們的排序的平均值。</p>
<p>之後再計算 ：</p>
<p><span class="math display">\[U_1=W_1+\frac{n(n+1)}{2}\]</span></p>
<p>最後拿來判斷的檢驗統計量是 <span class="math inline">\(U_1\)</span> 和 <span class="math inline">\(n\times m -U_1\)</span> 兩者中較小的數字。(注：如果我們一開始計算樣本量較多的部分的秩和 <span class="math inline">\(W_2=\sum_{i=1}^m R_i\)</span> 時，將計算的 <span class="math inline">\(U_2=W_2-\frac{m(m+1)}{2}\)</span>，跟 <span class="math inline">\(n\times m - U_2\)</span> 中較小的數字作爲檢驗統計量的話，我們會在數學上獲得完全一樣的檢驗統計量。)</p>
<p>其實兩個統計量 <span class="math inline">\(W, U\)</span> 均可以用來作相同的統計推斷，當然各自的 <span class="math inline">\(p\)</span> 值表格不同。但是 <span class="math inline">\(U\)</span> 有另外一種統計學含義：<span class="math inline">\(U\)</span> 是 <span class="math inline">\(X_i&gt;Y_j\)</span>， 也就是所有的 <span class="math inline">\((X_i, Y_j)\)</span> 配對中 <span class="math inline">\(X_i\)</span> 較大的對的個數。</p>
<p>這裏使用下面的例子來解釋如何操作 WMW 檢驗： 採集16名甲亢兒童的血清甲狀腺素濃度值列表如下，</p>
<div style="border: 1px solid #ddd; padding: 5px; margin-left: auto; margin-right: auto;overflow-y: scroll; height:500px; overflow-x: scroll; width:400px; ">
<table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-17">表 2.2: </span>Serum thyroxine levels
</caption>
<thead>
<tr>
<th style="text-align:center; border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;" colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
n=16 hypothyroid children
</div>
</th>
</tr>
<tr>
<th style="text-align:center;">
thyr
</th>
<th style="text-align:center;">
group
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
34
</td>
<td style="text-align:center;">
Slight or no symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
45
</td>
<td style="text-align:center;">
Slight or no symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
49
</td>
<td style="text-align:center;">
Slight or no symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
55
</td>
<td style="text-align:center;">
Slight or no symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
58
</td>
<td style="text-align:center;">
Slight or no symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
59
</td>
<td style="text-align:center;">
Slight or no symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
60
</td>
<td style="text-align:center;">
Slight or no symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
62
</td>
<td style="text-align:center;">
Slight or no symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
86
</td>
<td style="text-align:center;">
Slight or no symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
Marked symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
Marked symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
Marked symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
24
</td>
<td style="text-align:center;">
Marked symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
60
</td>
<td style="text-align:center;">
Marked symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
84
</td>
<td style="text-align:center;">
Marked symptoms
</td>
</tr>
<tr>
<td style="text-align:center;">
96
</td>
<td style="text-align:center;">
Marked symptoms
</td>
</tr>
</tbody>
</table>
</div>
<p>這裏我們需要比較輕微症狀組和嚴重症狀組的血清甲狀腺濃度的分佈是否只是左右位移，<span class="math inline">\(H_0: \Delta=0\)</span>。</p>
<p>首先，我們要給兩組合併後的濃度排序：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt<span class="op">$</span>rank &lt;-<span class="st"> </span><span class="kw">rank</span>(dt<span class="op">$</span>thyr)
dt &lt;-<span class="st"> </span>dt[<span class="kw">order</span>(dt<span class="op">$</span>rank),]
dt</code></pre></div>
<pre><code>##    thyr                 group rank
## 10    5       Marked symptoms  1.0
## 11    8       Marked symptoms  2.0
## 12   18       Marked symptoms  3.0
## 13   24       Marked symptoms  4.0
## 1    34 Slight or no symptoms  5.0
## 2    45 Slight or no symptoms  6.0
## 3    49 Slight or no symptoms  7.0
## 4    55 Slight or no symptoms  8.0
## 5    58 Slight or no symptoms  9.0
## 6    59 Slight or no symptoms 10.0
## 7    60 Slight or no symptoms 11.5
## 14   60       Marked symptoms 11.5
## 8    62 Slight or no symptoms 13.0
## 15   84       Marked symptoms 14.0
## 9    86 Slight or no symptoms 15.0
## 16   96       Marked symptoms 16.0</code></pre>
<p>Wilcoxon 統計量 <span class="math inline">\(W_1\)</span> 是人數少的組的排序之數值和。本樣本中 7 人有嚴重症狀，9人有輕微或無症狀。所以 <span class="math inline">\(W_1\)</span> 就是嚴重症狀組的秩和：</p>
<p><span class="math display">\[W_1=1+2+3+4+11.5+14+16=51.5\]</span></p>
<p>再計算統計量 <span class="math inline">\(U_1\)</span>：</p>
<p><span class="math display">\[U_1=W_1-\frac{n(n+1)}{2}=51.5-\frac{7\times(7+1)}{2}=23.5\]</span></p>
<p>所以 <span class="math inline">\(n\times m-U_1=7\times9-23.5=39.5\)</span>，顯然這兩個數值中小的 <span class="math inline">\(23.5\)</span> 就是我們尋找的 WMW 統計量。繼續查水錶：</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-19"></span>
<img src="img/Selection_093.png" alt="Critical Values of U for a Wilcoxon-Mann-Whitney test" width="80%" />
<p class="caption">
图 2.4: Critical Values of U for a Wilcoxon-Mann-Whitney test
</p>
</div>
<p>可知 <span class="math inline">\(n_1=7, n_2=9\)</span> 時，統計量要低於 <span class="math inline">\(15\)</span> <span class="math inline">\(p\)</span> 值才會小於 <span class="math inline">\(0.01\)</span>。所以數據給出的 <span class="math inline">\(p&gt;0.1\)</span>。</p>
<p>在 <a href="https://www.r-project.org/">R</a> 裏面用下面的代碼進行 WHW 檢驗：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(dt<span class="op">$</span>thyr<span class="op">~</span>dt<span class="op">$</span>group, <span class="dt">correct=</span><span class="ot">FALSE</span>) <span class="co"># without continuity correction</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  dt$thyr by dt$group
## W = 23.5, p-value = 0.39675
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wilcox.test</span>(dt<span class="op">$</span>thyr<span class="op">~</span>dt<span class="op">$</span>group) <span class="co"># with continuity correction i.e. normal appriximation</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  dt$thyr by dt$group
## W = 23.5, p-value = 0.42692
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div id="spearmans-rank-correlation-coefficient" class="section level2">
<h2><span class="header-section-number">2.4</span> 秩相關，Spearman’s Rank Correlation Coefficient</h2>
<p>Spearman 的秩相關 (通常用 <span class="math inline">\(\rho\)</span>)，是一種基於數據排序的相關係數算法。和傳統的 Pearson 相關係數類比，是當數據無法被認定是線性相關時的另一種相關關係檢驗方法。所以秩相關不假定兩組數據之間是線性相關 (linear association)。秩相關只關心一個數據遞增時，另一個數據是否單調遞增。所以可以用於傾向性檢驗。</p>
<p>具體的操作是，在兩組數據中先各自排序，像所有的排序檢驗一樣遇到相同大小的數值將排序取均值。之後使用一般的求相關係數的方法。本法中只用到了數值在各自組中的排序，並沒有使用他們的真實大小。近似法的秩相關計算公式爲：</p>
<p><span class="math display">\[\hat\tau=\frac{\hat\rho}{\sqrt{(1-\hat\rho^2)/(n-2)}}\]</span></p>
<p>在零假設條件下 <span class="math inline">\(H_0: \rho=0\)</span>，上面的近似法秩相關服從 <span class="math inline">\(t_{n-2}\)</span> 分佈。 下面用某血友病患者調查數據獲得的血液 <span class="math inline">\(T_4, T_8\)</span> 淋巴球計數 <span class="math inline">\((\times10^9/\ell)\)</span> 來詳細解釋計算過程：</p>
<div style="border: 1px solid #ddd; padding: 5px; margin-left: auto; margin-right: auto;overflow-y: scroll; height:500px; overflow-x: scroll; width:400px; ">
<table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-21">表 2.3: </span>Lymphocyte counts
</caption>
<thead>
<tr>
<th style="text-align:center; border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;" colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
n=28 haemophiliacs
</div>
</th>
</tr>
<tr>
<th style="text-align:center;">
th4
</th>
<th style="text-align:center;">
th8
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0.20
</td>
<td style="text-align:center;">
0.17
</td>
</tr>
<tr>
<td style="text-align:center;">
0.27
</td>
<td style="text-align:center;">
0.52
</td>
</tr>
<tr>
<td style="text-align:center;">
0.28
</td>
<td style="text-align:center;">
0.25
</td>
</tr>
<tr>
<td style="text-align:center;">
0.37
</td>
<td style="text-align:center;">
0.34
</td>
</tr>
<tr>
<td style="text-align:center;">
0.38
</td>
<td style="text-align:center;">
0.14
</td>
</tr>
<tr>
<td style="text-align:center;">
0.48
</td>
<td style="text-align:center;">
0.10
</td>
</tr>
<tr>
<td style="text-align:center;">
0.49
</td>
<td style="text-align:center;">
0.58
</td>
</tr>
<tr>
<td style="text-align:center;">
0.56
</td>
<td style="text-align:center;">
0.23
</td>
</tr>
<tr>
<td style="text-align:center;">
0.60
</td>
<td style="text-align:center;">
0.24
</td>
</tr>
<tr>
<td style="text-align:center;">
0.64
</td>
<td style="text-align:center;">
0.67
</td>
</tr>
<tr>
<td style="text-align:center;">
0.64
</td>
<td style="text-align:center;">
0.90
</td>
</tr>
<tr>
<td style="text-align:center;">
0.66
</td>
<td style="text-align:center;">
0.26
</td>
</tr>
<tr>
<td style="text-align:center;">
0.70
</td>
<td style="text-align:center;">
0.61
</td>
</tr>
<tr>
<td style="text-align:center;">
0.77
</td>
<td style="text-align:center;">
0.18
</td>
</tr>
<tr>
<td style="text-align:center;">
0.88
</td>
<td style="text-align:center;">
0.74
</td>
</tr>
<tr>
<td style="text-align:center;">
0.88
</td>
<td style="text-align:center;">
0.54
</td>
</tr>
<tr>
<td style="text-align:center;">
0.88
</td>
<td style="text-align:center;">
0.76
</td>
</tr>
<tr>
<td style="text-align:center;">
0.90
</td>
<td style="text-align:center;">
0.62
</td>
</tr>
<tr>
<td style="text-align:center;">
1.02
</td>
<td style="text-align:center;">
0.48
</td>
</tr>
<tr>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
0.58
</td>
</tr>
<tr>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
0.34
</td>
</tr>
<tr>
<td style="text-align:center;">
1.18
</td>
<td style="text-align:center;">
0.84
</td>
</tr>
<tr>
<td style="text-align:center;">
1.20
</td>
<td style="text-align:center;">
0.63
</td>
</tr>
<tr>
<td style="text-align:center;">
1.30
</td>
<td style="text-align:center;">
0.46
</td>
</tr>
<tr>
<td style="text-align:center;">
1.40
</td>
<td style="text-align:center;">
0.84
</td>
</tr>
<tr>
<td style="text-align:center;">
1.60
</td>
<td style="text-align:center;">
1.20
</td>
</tr>
<tr>
<td style="text-align:center;">
1.64
</td>
<td style="text-align:center;">
0.59
</td>
</tr>
<tr>
<td style="text-align:center;">
2.40
</td>
<td style="text-align:center;">
1.30
</td>
</tr>
</tbody>
</table>
</div>
<p>給這組數據繪製散點圖：</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-22"></span>
<img src="06-RobustStatistic_files/figure-html/unnamed-chunk-22-1.png" alt="Scatter plot of T4 and T8 counts" width="80%" />
<p class="caption">
图 2.5: Scatter plot of T4 and T8 counts
</p>
</div>
<p>可以看見圖中右上角的兩個點幾乎可以認爲是異常值 (outliers)。 分別給 <code>th4, th8</code> 求各自的排序：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt<span class="op">$</span>rank4 &lt;-<span class="st"> </span><span class="kw">rank</span>(dt<span class="op">$</span>th4)
dt<span class="op">$</span>rank8 &lt;-<span class="st"> </span><span class="kw">rank</span>(dt<span class="op">$</span>th8)
<span class="kw">kable</span>(dt, <span class="st">&quot;html&quot;</span>, <span class="dt">align =</span> <span class="st">&quot;c&quot;</span>,<span class="dt">caption =</span> <span class="st">&quot;Lymphocyte counts&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;bordered&quot;</span>)) <span class="op">%&gt;%</span>
<span class="co">#  collapse_rows(columns = c(1)) %&gt;%</span>
<span class="st">  </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot;n=28 haemophiliacs with ranks&quot;</span> =<span class="st"> </span><span class="dv">4</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">scroll_box</span>(<span class="dt">width =</span> <span class="st">&quot;400px&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;500px&quot;</span>, <span class="dt">extra_css=</span><span class="st">&quot;margin-left: auto; margin-right: auto;&quot;</span>)</code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; margin-left: auto; margin-right: auto;overflow-y: scroll; height:500px; overflow-x: scroll; width:400px; ">
<table class="table table-striped table-bordered" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-23">表 2.4: </span>Lymphocyte counts
</caption>
<thead>
<tr>
<th style="text-align:center; border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;" colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
n=28 haemophiliacs with ranks
</div>
</th>
</tr>
<tr>
<th style="text-align:center;">
th4
</th>
<th style="text-align:center;">
th8
</th>
<th style="text-align:center;">
rank4
</th>
<th style="text-align:center;">
rank8
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
0.20
</td>
<td style="text-align:center;">
0.17
</td>
<td style="text-align:center;">
1.0
</td>
<td style="text-align:center;">
3.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.27
</td>
<td style="text-align:center;">
0.52
</td>
<td style="text-align:center;">
2.0
</td>
<td style="text-align:center;">
13.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.28
</td>
<td style="text-align:center;">
0.25
</td>
<td style="text-align:center;">
3.0
</td>
<td style="text-align:center;">
7.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.37
</td>
<td style="text-align:center;">
0.34
</td>
<td style="text-align:center;">
4.0
</td>
<td style="text-align:center;">
9.5
</td>
</tr>
<tr>
<td style="text-align:center;">
0.38
</td>
<td style="text-align:center;">
0.14
</td>
<td style="text-align:center;">
5.0
</td>
<td style="text-align:center;">
2.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.48
</td>
<td style="text-align:center;">
0.10
</td>
<td style="text-align:center;">
6.0
</td>
<td style="text-align:center;">
1.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.49
</td>
<td style="text-align:center;">
0.58
</td>
<td style="text-align:center;">
7.0
</td>
<td style="text-align:center;">
15.5
</td>
</tr>
<tr>
<td style="text-align:center;">
0.56
</td>
<td style="text-align:center;">
0.23
</td>
<td style="text-align:center;">
8.0
</td>
<td style="text-align:center;">
5.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.60
</td>
<td style="text-align:center;">
0.24
</td>
<td style="text-align:center;">
9.0
</td>
<td style="text-align:center;">
6.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.64
</td>
<td style="text-align:center;">
0.67
</td>
<td style="text-align:center;">
10.5
</td>
<td style="text-align:center;">
21.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.64
</td>
<td style="text-align:center;">
0.90
</td>
<td style="text-align:center;">
10.5
</td>
<td style="text-align:center;">
26.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.66
</td>
<td style="text-align:center;">
0.26
</td>
<td style="text-align:center;">
12.0
</td>
<td style="text-align:center;">
8.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.70
</td>
<td style="text-align:center;">
0.61
</td>
<td style="text-align:center;">
13.0
</td>
<td style="text-align:center;">
18.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.77
</td>
<td style="text-align:center;">
0.18
</td>
<td style="text-align:center;">
14.0
</td>
<td style="text-align:center;">
4.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.88
</td>
<td style="text-align:center;">
0.74
</td>
<td style="text-align:center;">
16.0
</td>
<td style="text-align:center;">
22.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.88
</td>
<td style="text-align:center;">
0.54
</td>
<td style="text-align:center;">
16.0
</td>
<td style="text-align:center;">
14.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.88
</td>
<td style="text-align:center;">
0.76
</td>
<td style="text-align:center;">
16.0
</td>
<td style="text-align:center;">
23.0
</td>
</tr>
<tr>
<td style="text-align:center;">
0.90
</td>
<td style="text-align:center;">
0.62
</td>
<td style="text-align:center;">
18.0
</td>
<td style="text-align:center;">
19.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1.02
</td>
<td style="text-align:center;">
0.48
</td>
<td style="text-align:center;">
19.0
</td>
<td style="text-align:center;">
12.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
0.58
</td>
<td style="text-align:center;">
20.5
</td>
<td style="text-align:center;">
15.5
</td>
</tr>
<tr>
<td style="text-align:center;">
1.10
</td>
<td style="text-align:center;">
0.34
</td>
<td style="text-align:center;">
20.5
</td>
<td style="text-align:center;">
9.5
</td>
</tr>
<tr>
<td style="text-align:center;">
1.18
</td>
<td style="text-align:center;">
0.84
</td>
<td style="text-align:center;">
22.0
</td>
<td style="text-align:center;">
24.5
</td>
</tr>
<tr>
<td style="text-align:center;">
1.20
</td>
<td style="text-align:center;">
0.63
</td>
<td style="text-align:center;">
23.0
</td>
<td style="text-align:center;">
20.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1.30
</td>
<td style="text-align:center;">
0.46
</td>
<td style="text-align:center;">
24.0
</td>
<td style="text-align:center;">
11.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1.40
</td>
<td style="text-align:center;">
0.84
</td>
<td style="text-align:center;">
25.0
</td>
<td style="text-align:center;">
24.5
</td>
</tr>
<tr>
<td style="text-align:center;">
1.60
</td>
<td style="text-align:center;">
1.20
</td>
<td style="text-align:center;">
26.0
</td>
<td style="text-align:center;">
27.0
</td>
</tr>
<tr>
<td style="text-align:center;">
1.64
</td>
<td style="text-align:center;">
0.59
</td>
<td style="text-align:center;">
27.0
</td>
<td style="text-align:center;">
17.0
</td>
</tr>
<tr>
<td style="text-align:center;">
2.40
</td>
<td style="text-align:center;">
1.30
</td>
<td style="text-align:center;">
28.0
</td>
<td style="text-align:center;">
28.0
</td>
</tr>
</tbody>
</table>
</div>
<p>接下來再給 <code>th4, th8</code> 的排序做散點圖：</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-24"></span>
<img src="06-RobustStatistic_files/figure-html/unnamed-chunk-24-1.png" alt="Scatter plot of T4 and T8 ranks" width="80%" />
<p class="caption">
图 2.6: Scatter plot of T4 and T8 ranks
</p>
</div>
<p>此時也就沒有了異常值的存在。對二者的排序計算相關係數：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(dt<span class="op">$</span>rank4, dt<span class="op">$</span>rank8)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dt$rank4 and dt$rank8
## t = 4.11513, df = 26, p-value = 0.00034606
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.33297073 0.81107104
## sample estimates:
##        cor 
## 0.62803129</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(dt<span class="op">$</span>th4, dt<span class="op">$</span>th8)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dt$th4 and dt$th8
## t = 5.28031, df = 26, p-value = 0.000016061
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.47328797 0.86128090
## sample estimates:
##        cor 
## 0.71934766</code></pre>
<p>秩相關的相關係數爲 <span class="math inline">\(0.628\)</span>。而原始數據的相關係數爲 <span class="math inline">\(0.719\)</span>。</p>
</div>
<div id="section-2.5" class="section level2">
<h2><span class="header-section-number">2.5</span> 基於秩次的非參數檢驗的優缺點</h2>
<p>優點：</p>
<ul>
<li>可以讓我們拋棄很多 (正態分佈等的) 前提假設，許多真實數據本身並不能滿足這些條件，這些情況下，基於秩次的非參數檢驗能提供更高的統計效能 (power)。</li>
</ul>
<p>缺點：</p>
<ul>
<li>如果數據本身能夠滿足如正態分佈之類的假設，那麼相比較與一般的參數檢驗，基於秩次的非參數檢驗法效能就偏低。</li>
<li>基於秩次的非參數檢驗較難推廣到更加複雜的情況。</li>
<li>這些檢驗法僅僅只能幫助我們進行假設檢驗。但是多數情況下，我們更加希望能使用觀察數據對總體進行點估計 (point estimates) 並且給出信賴區間 (CIs)。通常情況下，基於秩次的非參數檢驗法就很難給出這樣的估計。</li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="-permutation-procedures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/winterwang/LSHTMlearningnote/edit/master/%s",
"text": "缂栬緫"
},
"download": null,
"toc": {
"collapse": "none"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
